module.exports = function tryJSON(data, validator) {
    var retData = data;

    if (typeof retData === 'string')
    {
        try
        {   // handle different types of data input: JSON or raw object
            retData = JSON.parse(retData);    // throws SyntaxError if not valid JSON string
        } catch (err)
        {   // pass
        }
    }

    if (!validator(retData))
    {
        console.trace();
        console.group('Malformed data');
        console.error('data', data);
        console.error('retData', retData);
        console.error('validator', validator);
        console.groupEnd();
        throw 'Malformed data';
    }

    return retData;
};
